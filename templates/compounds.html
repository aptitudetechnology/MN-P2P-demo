{% extends "base.html" %}
{% block content %}
<div class="row">
  <div class="col-12">
    <h1>Molecular Compounds Database</h1>
    <p class="lead">Scientific compound analysis and therapeutic target research</p>
    <p class="text-muted">Explore molecular structures, pathways, and therapeutic applications</p>
  </div>
</div>

<!-- Search and Filter Section -->
<div class="row mt-4">
  <div class="col-12">
    <div class="card">
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <div class="input-group">
              <input type="text" id="compound-search" class="form-control" placeholder="Search compounds (e.g., Imidazole propionate)">
              <button class="btn btn-primary" onclick="searchCompounds()">
                <i class="bi bi-search"></i> Search
              </button>
            </div>
          </div>
          <div class="col-md-3">
            <select class="form-select" id="category-filter">
              <option value="">All Categories</option>
              <option value="metabolite">Metabolites</option>
              <option value="therapeutic">Therapeutic Targets</option>
              <option value="biomarker">Biomarkers</option>
              <option value="pathway">Pathway Modulators</option>
            </select>
          </div>
          <div class="col-md-3">
            <select class="form-select" id="disease-filter">
              <option value="">All Diseases</option>
              <option value="atherosclerosis">Atherosclerosis</option>
              <option value="cardiovascular">Cardiovascular</option>
              <option value="metabolic">Metabolic Disorders</option>
              <option value="inflammatory">Inflammatory</option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Featured Compound: Imidazole Propionate -->
<div class="row mt-4">
  <div class="col-12">
    <div class="card border-primary">
      <div class="card-header bg-primary text-white">
        <h4 class="mb-0"><i class="bi bi-star-fill"></i> Featured Compound: Imidazole Propionate</h4>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-4">
            <div class="card bg-light">
              <div class="card-body text-center">
                <h6 class="card-title">Molecular Structure</h6>
                <!-- Placeholder for molecular structure -->
                <div class="bg-white p-3 rounded border" style="min-height: 200px;">
                  <svg width="100%" height="180" viewBox="0 0 200 180">
                    <!-- Simplified imidazole ring structure -->
                    <polygon points="50,80 80,60 110,80 100,110 60,110" 
                             fill="none" stroke="#007bff" stroke-width="2"/>
                    <!-- Propionate chain -->
                    <line x1="110" y1="80" x2="140" y2="80" stroke="#007bff" stroke-width="2"/>
                    <line x1="140" y1="80" x2="160" y2="100" stroke="#007bff" stroke-width="2"/>
                    <line x1="160" y1="100" x2="180" y2="80" stroke="#007bff" stroke-width="2"/>
                    <!-- Labels -->
                    <text x="75" y="50" text-anchor="middle" class="small">Imidazole</text>
                    <text x="150" y="70" text-anchor="middle" class="small">Propionate</text>
                    <!-- Atoms -->
                    <circle cx="50" cy="80" r="3" fill="#ff6b6b"/>
                    <circle cx="80" cy="60" r="3" fill="#4ecdc4"/>
                    <circle cx="110" cy="80" r="3" fill="#ff6b6b"/>
                    <circle cx="180" cy="80" r="3" fill="#feca57"/>
                  </svg>
                </div>
                <small class="text-muted">C₆H₈N₂O₂</small>
              </div>
            </div>
          </div>
          <div class="col-md-8">
            <div class="row">
              <div class="col-md-6">
                <h6><i class="bi bi-info-circle"></i> Compound Properties</h6>
                <table class="table table-sm">
                  <tr><td><strong>IUPAC Name:</strong></td><td>3-(1H-imidazol-4-yl)propanoic acid</td></tr>
                  <tr><td><strong>Molecular Formula:</strong></td><td>C₆H₈N₂O₂</td></tr>
                  <tr><td><strong>Molecular Weight:</strong></td><td>140.14 g/mol</td></tr>
                  <tr><td><strong>CAS Number:</strong></td><td>104-98-3</td></tr>
                  <tr><td><strong>Solubility:</strong></td><td>Water soluble</td></tr>
                  <tr><td><strong>Source:</strong></td><td>Bacterial metabolism</td></tr>
                </table>
              </div>
              <div class="col-md-6">
                <h6><i class="bi bi-heart-pulse"></i> Therapeutic Relevance</h6>
                <div class="mb-2">
                  <span class="badge bg-danger">Atherosclerosis Driver</span>
                  <span class="badge bg-info">Metabolite</span>
                  <span class="badge bg-success">Therapeutic Target</span>
                </div>
                <p class="small">
                  Imidazole propionate is a bacterial metabolite that acts as a key driver of atherosclerosis 
                  through mTORC1 activation and metabolic dysfunction. It represents a promising therapeutic 
                  target for cardiovascular disease intervention.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Mechanism of Action -->
<div class="row mt-4">
  <div class="col-md-6">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-diagram-3"></i> Mechanism of Action</h5>
      </div>
      <div class="card-body">
        <div class="pathway-diagram bg-light p-3 rounded">
          <div class="text-center mb-3">
            <strong>Imidazole Propionate → Atherosclerosis Pathway</strong>
          </div>
          <div class="d-flex justify-content-between align-items-center mb-2">
            <span class="badge bg-primary">Bacterial Production</span>
            <i class="bi bi-arrow-right"></i>
            <span class="badge bg-warning">Gut Absorption</span>
          </div>
          <div class="text-center mb-2">
            <i class="bi bi-arrow-down"></i>
          </div>
          <div class="d-flex justify-content-between align-items-center mb-2">
            <span class="badge bg-info">mTORC1 Activation</span>
            <i class="bi bi-arrow-right"></i>
            <span class="badge bg-danger">Metabolic Dysfunction</span>
          </div>
          <div class="text-center mb-2">
            <i class="bi bi-arrow-down"></i>
          </div>
          <div class="text-center">
            <span class="badge bg-dark">Atherosclerotic Plaque Formation</span>
          </div>
        </div>
        <div class="mt-3">
          <h6>Key Targets:</h6>
          <ul class="list-unstyled">
            <li><i class="bi bi-dot"></i> mTORC1 signaling pathway</li>
            <li><i class="bi bi-dot"></i> Insulin sensitivity modulation</li>
            <li><i class="bi bi-dot"></i> Lipid metabolism disruption</li>
            <li><i class="bi bi-dot"></i> Inflammatory response activation</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  
  <div class="col-md-6">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-graph-up"></i> Research Data</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-6 text-center">
            <div class="bg-light p-3 rounded mb-2">
              <h4 class="text-primary mb-1">2.5x</h4>
              <small>Increased CVD Risk</small>
            </div>
          </div>
          <div class="col-6 text-center">
            <div class="bg-light p-3 rounded mb-2">
              <h4 class="text-warning mb-1">40%</h4>
              <small>mTORC1 Activation</small>
            </div>
          </div>
          <div class="col-6 text-center">
            <div class="bg-light p-3 rounded mb-2">
              <h4 class="text-info mb-1">15%</h4>
              <small>Insulin Resistance</small>
            </div>
          </div>
          <div class="col-6 text-center">
            <div class="bg-light p-3 rounded mb-2">
              <h4 class="text-success mb-1">60%</h4>
              <small>Reduction Potential</small>
            </div>
          </div>
        </div>
        <div class="mt-3">
          <h6>Recent Studies:</h6>
          <ul class="small">
            <li>Association with T2D and atherosclerosis (Nature, 2018)</li>
            <li>mTORC1-dependent metabolic effects (Cell Metabolism, 2019)</li>
            <li>Therapeutic intervention strategies (JACC, 2021)</li>
          </ul>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Therapeutic Applications -->
<div class="row mt-4">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-prescription2"></i> Therapeutic Applications & Drug Development</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-4">
            <div class="card border-success">
              <div class="card-header bg-success text-white">
                <h6 class="mb-0">Direct Inhibition</h6>
              </div>
              <div class="card-body">
                <ul class="list-unstyled">
                  <li><i class="bi bi-check-circle text-success"></i> Competitive inhibitors</li>
                  <li><i class="bi bi-check-circle text-success"></i> Allosteric modulators</li>
                  <li><i class="bi bi-clock text-warning"></i> Synthetic analogues</li>
                  <li><i class="bi bi-clock text-warning"></i> Prodrug strategies</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card border-info">
              <div class="card-header bg-info text-white">
                <h6 class="mb-0">Pathway Modulation</h6>
              </div>
              <div class="card-body">
                <ul class="list-unstyled">
                  <li><i class="bi bi-check-circle text-success"></i> mTORC1 inhibitors</li>
                  <li><i class="bi bi-check-circle text-success"></i> Metformin analogs</li>
                  <li><i class="bi bi-clock text-warning"></i> AMPK activators</li>
                  <li><i class="bi bi-clock text-warning"></i> Insulin sensitizers</li>
                </ul>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card border-warning">
              <div class="card-header bg-warning text-white">
                <h6 class="mb-0">Microbiome Targeting</h6>
              </div>
              <div class="card-body">
                <ul class="list-unstyled">
                  <li><i class="bi bi-clock text-warning"></i> Probiotic interventions</li>
                  <li><i class="bi bi-clock text-warning"></i> Prebiotic strategies</li>
                  <li><i class="bi bi-clock text-warning"></i> Bacterial enzyme inhibitors</li>
                  <li><i class="bi bi-x-circle text-danger"></i> Antibiotic approaches</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Related Compounds -->
<div class="row mt-4">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-collection"></i> Related Compounds</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-3">
            <div class="card">
              <div class="card-body text-center">
                <h6>Histidine</h6>
                <small class="text-muted">Precursor</small>
                <br>
                <span class="badge bg-secondary">C₆H₉N₃O₂</span>
                <p class="small mt-2">Amino acid precursor of imidazole propionate through bacterial metabolism</p>
              </div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="card">
              <div class="card-body text-center">
                <h6>Urocanic acid</h6>
                <small class="text-muted">Intermediate</small>
                <br>
                <span class="badge bg-secondary">C₆H₆N₂O₂</span>
                <p class="small mt-2">Histidine metabolite in the pathway to imidazole propionate</p>
              </div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="card">
              <div class="card-body text-center">
                <h6>Imidazole acetate</h6>
                <small class="text-muted">Analog</small>
                <br>
                <span class="badge bg-secondary">C₅H₆N₂O₂</span>
                <p class="small mt-2">Structural analog with different metabolic effects</p>
              </div>
            </div>
          </div>
          <div class="col-md-3">
            <div class="card">
              <div class="card-body text-center">
                <h6>TMAO</h6>
                <small class="text-muted">Co-factor</small>
                <br>
                <span class="badge bg-secondary">C₃H₉NO</span>
                <p class="small mt-2">Trimethylamine oxide - another gut-derived CVD risk factor</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Computational Analysis Section -->
<div class="row mt-4">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
        <h5 class="mb-0"><i class="bi bi-cpu"></i> Computational Analysis</h5>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-md-6">
            <h6>Molecular Dynamics Simulation</h6>
            <div class="input-group mb-3">
              <input type="text" class="form-control" value="Imidazole propionate" readonly>
              <button class="btn btn-primary" onclick="runMDSimulation()">
                <i class="bi bi-play"></i> Run MD Simulation
              </button>
            </div>
            <div id="md-result" class="bg-light p-3 rounded small">
              Ready to simulate molecular dynamics...
            </div>
          </div>
          <div class="col-md-6">
            <h6>Docking Analysis</h6>
            <select class="form-select mb-2">
              <option>mTORC1 binding site</option>
              <option>Insulin receptor</option>
              <option>AMPK binding domain</option>
            </select>
            <button class="btn btn-success w-100 mb-2" onclick="runDocking()">
              <i class="bi bi-bullseye"></i> Perform Docking
            </button>
            <div id="docking-result" class="bg-light p-3 rounded small">
              Select target and run docking analysis...
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Action Buttons -->
<div class="row mt-4">
  <div class="col-12">
    <div class="card">
      <div class="card-body">
        <h5 class="card-title"><i class="bi bi-tools"></i> Research Tools</h5>
        <div class="btn-group" role="group">
          <button class="btn btn-outline-primary" onclick="exportData()">
            <i class="bi bi-download"></i> Export Data
          </button>
          <button class="btn btn-outline-info" onclick="sharePeerData()">
            <i class="bi bi-share"></i> Share via P2P
          </button>
          <button class="btn btn-outline-success" onclick="addToCollection()">
            <i class="bi bi-bookmark-plus"></i> Add to Collection
          </button>
          <a href="{{ url_for('main.simulate') }}" class="btn btn-outline-warning">
            <i class="bi bi-calculator"></i> Run Simulation
          </a>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// Search functionality
function searchCompounds() {
  const query = document.getElementById('compound-search').value;
  console.log('Searching for:', query);
  // Implement search logic
}

// Simulation functions
function runMDSimulation() {
  const resultDiv = document.getElementById('md-result');
  resultDiv.innerHTML = '<div class="spinner-border spinner-border-sm" role="status"></div> Running simulation...';
  
  setTimeout(() => {
    resultDiv.innerHTML = `
      <strong>MD Simulation Results:</strong><br>
      • Average RMSD: 2.3 Å<br>
      • Binding affinity: -7.2 kcal/mol<br>
      • Simulation time: 100 ns<br>
      • Stable conformation identified
    `;
  }, 3000);
}

function runDocking() {
  const resultDiv = document.getElementById('docking-result');
  resultDiv.innerHTML = '<div class="spinner-border spinner-border-sm" role="status"></div> Performing docking...';
  
  setTimeout(() => {
    resultDiv.innerHTML = `
      <strong>Docking Results:</strong><br>
      • Binding score: -8.1 kcal/mol<br>
      • Key interactions: 3 H-bonds<br>
      • Binding pocket: Active site<br>
      • Druggability: High
    `;
  }, 2000);
}

// Export and sharing functions
function exportData() {
  alert('Exporting compound data...');
}

function sharePeerData() {
  alert('Sharing data via P2P network...');
}

function addToCollection() {
  alert('Added to your compound collection!');
}
</script>

{% endblock %}